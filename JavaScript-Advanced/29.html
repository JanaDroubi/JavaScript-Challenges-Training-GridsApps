<!DOCTYPE html>
<html>
<head><title>Challenge 29: Pretty Print JSON</title></head>
<body>
<h1>Pretty Print JSON from API</h1>
<button onclick="fetchAndPrettyPrint()">Fetch & Pretty Print</button>
<button onclick="showCompact()">Show Compact Version</button>
<button onclick="showCode()">Show Code</button>
<pre id="jsonOutput" style="background:#f5f5f5; padding:15px; max-height:500px; overflow:auto;"></pre>
<div id="code" style="display:none; background:#f5f5f5; padding:10px;"></div>
<script>
async function fetchAndPrettyPrint() {
    try {
        const response = await fetch('https://jsonplaceholder.typicode.com/users/1');
        const user = await response.json();
        
        // Pretty print with 2-space indentation
        const prettyJSON = JSON.stringify(user, null, 2);
        
        document.getElementById('jsonOutput').innerHTML = 
            `<strong>Pretty JSON (User #1):</strong>\n${prettyJSON}`;
        
        console.log('Pretty JSON:', prettyJSON);
        
    } catch (error) {
        document.getElementById('jsonOutput').innerHTML = `Error: ${error.message}`;
    }
}

function showCompact() {
    fetch('https://jsonplaceholder.typicode.com/users/1')
        .then(response => response.json())
        .then(user => {
            const compactJSON = JSON.stringify(user);
            document.getElementById('jsonOutput').innerHTML = 
                `<strong>Compact JSON:</strong>\n${compactJSON}`;
            console.log('Compact JSON length:', compactJSON.length);
        });
}

function showCode() {
    document.getElementById('code').innerHTML = 
`// Pretty print JSON from API
async function fetchAndPrettyPrint() {
    const response = await fetch('https://jsonplaceholder.typicode.com/users/1');
    const data = await response.json();
    
    // Method 1: 2-space indentation (most common)
    const prettyJSON1 = JSON.stringify(data, null, 2);
    
    // Method 2: 4-space indentation
    const prettyJSON2 = JSON.stringify(data, null, 4);
    
    // Method 3: Tab indentation
    const prettyJSON3 = JSON.stringify(data, null, '\\t');
    
    // Method 4: Custom indentation
    const prettyJSON4 = JSON.stringify(data, null, '---');
    
    // Display in <pre> tag for proper formatting
    document.getElementById('output').innerHTML = \`
        <strong>Pretty Printed JSON:</strong>
        <pre>\${prettyJSON1}</pre>
    \`;
    
    return prettyJSON1;
}

// Compare sizes
function compareJSONSizes(data) {
    const compact = JSON.stringify(data);
    const pretty2 = JSON.stringify(data, null, 2);
    const pretty4 = JSON.stringify(data, null, 4);
    
    console.log(\`Compact: \${compact.length} characters\`);
    console.log(\`Pretty (2 spaces): \${pretty2.length} characters\`);
    console.log(\`Pretty (4 spaces): \${pretty4.length} characters\`);
    
    return {
        compact: compact.length,
        pretty2: pretty2.length,
        pretty4: pretty4.length,
        increase2: Math.round((pretty2.length - compact.length) / compact.length * 100) + '%',
        increase4: Math.round((pretty4.length - compact.length) / compact.length * 100) + '%'
    };
}

// Syntax highlighting (basic)
function syntaxHighlight(json) {
    if (typeof json != 'string') {
        json = JSON.stringify(json, null, 2);
    }
    
    // Simple syntax highlighting
    json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
    return json.replace(
        /("(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g,
        function(match) {
            let cls = 'json-number';
            if (/^"/.test(match)) {
                if (/:$/.test(match)) {
                    cls = 'json-key';
                } else {
                    cls = 'json-string';
                }
            } else if (/true|false/.test(match)) {
                cls = 'json-boolean';
            } else if (/null/.test(match)) {
                cls = 'json-null';
            }
            return \`<span class="\${cls}">\${match}</span>\`;
        }
    );
}

// Display with syntax highlighting
function displayPrettyJSON(data) {
    const highlighted = syntaxHighlight(data);
    document.getElementById('output').innerHTML = \`
        <div style="font-family: monospace; white-space: pre;">\${highlighted}</div>
    \`;
}`;
    document.getElementById('code').style.display = 'block';
}
</script>
</body>
</html>